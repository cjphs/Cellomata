(()=>{var t={686:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const i=class{constructor(t,e,n,i,s){this.width=t,this.height=e,this.rules=n,this.wrap=s,this.grid=this.getEmptyGrid(),this.stateCounts={},this.stateCols={},this.rules.states.forEach((t=>{this.stateCounts[t]=0}))}getEmptyGrid=function(){const t=[[]];for(let e=0;e<this.height;e++){t[e]=[];for(let n=0;n<this.width;n++)t[e][n]=this.rules.getDefaultState()}return t};getStateCounts=function(){return this.stateCounts};resetGrid=function(t=!1){if(t)for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++)this.rules.states.includes(this.getCellState(e,t))||this.setCellState(e,t,this.rules.getDefaultState());else this.grid=this.getEmptyGrid()};coordinatesInBounds=function(t,e){return t>=0&t<this.width&e>=0&e<this.height};getCellState=function(t,e){this.wrap&&(t=(this.width+t)%this.width,e=(this.height+e)%this.height);var n="";return this.coordinatesInBounds(t,e)&&(n=this.grid[e][t]),n};setCellState=function(t,e,n){this.coordinatesInBounds(t,e)&&(this.grid[e][t]=n)};evolve=function(){var t=this.getEmptyGrid();let e={};this.rules.states.forEach((t=>{e[t]=0}));for(var n=0;n<this.height;n++)for(var i=0;i<this.width;i++){var s=this.getCellState(i,n);t[n][i]=s;for(var a=this.rules.getStatesDict(),r=i-1;r<i+2;r++)for(var l=n-1;l<n+2;l++)if(r!=i||l!=n){var o=this.getCellState(r,l);""!=o&&(a[o]+=1)}a["*below"]=this.getCellState(i,n+1),a["*above"]=this.getCellState(i,n-1),a["*left"]=this.getCellState(i-1,n),a["*right"]=this.getCellState(i+1,n),a["*bottomleft"]=this.getCellState(i-1,n+1),a["*bottomright"]=this.getCellState(i+1,n+1),a["*topleft"]=this.getCellState(i-1,n-1),a["*topright"]=this.getCellState(i+1,n-1);t:for(let r=0;r<this.rules.clauses[s].length;r++){let l=this.rules.clauses[s][r];if(!l.do_evaluation)continue t;let o=l.evaluate(a);if(o)for(;null!=l.conjucted_with&&(l=l.conjucted_with,o=l.evaluate(a),o););if(o){t[n][i]=l.transformState,e[t[n][i]]+=1;break t}}}this.stateCounts=e,this.grid=t};asString=function(t=",",e="\n"){let n="";for(let i=0;i<this.height;i++){for(let e=0;e<this.width;e++)n+=this.grid[i][e]+(e<this.width-1?t:"");n+=e}return n}}},829:(t,e,n)=>{"use strict";n.r(e),n.d(e,{interpretRules:()=>b,recalc_grid_size:()=>w,reset_grid:()=>g,state_cols:()=>f,variables:()=>y});const i=class{constructor(t,e,n="",i=-1,s=1,a=0,r=9){this.transformState=t,this.localityCheckType=e,this.localityCheckState=n,this.localityCount=i,this.localityRangeMin=a,this.localityRangeMax=r,this.chance=s,this.conjucted_with=null,this.do_evaluation=!0,this.equality_type="="}conjunctWith=function(t){this.conjucted_with=t};evaluate=function(t){if(Math.random()>=this.chance)return!1;switch(this.localityCheckType){case"always":return!0;case"nearby":{let e=t[this.localityCheckState];return this.localityRangeMin<=e&&e<=this.localityRangeMax}case"majority":{let e=0,n="";return states.forEach((i=>{t[i]>e&&(e=t[i],n=i)})),n===this.localityCheckState}default:return 0!==this.localityCount?t["*"+this.localityCheckType]===this.localityCheckState:t["*"+this.localityCheckType]!==this.localityCheckState}}},s=class{constructor(t){this.states=t,this.clauses={},this.states.forEach((t=>{this.clauses[t]=[]}))}addRule=function(t,e){this.clauses[t].push(e)};getDefaultState=function(){return this.states[0]};getStatesDict=function(t=0){const e={};return this.states.forEach((n=>{e[n]=t})),e}},a=["with","w/","w"],r=["chance","probability","prob","%"],l=["becomes:","->",":"],o=["and","&"],c=["@width","@w"],h=["@height","@h"],u=["@wrap"],d=["@colors","@colours"];let f={},g=!1,w=!1,p=[],y={};const b=function(t){let e=100,n=100,f=!1,b=0,m=null,E="";y={};let C={};return w=!1,t.split("\n").forEach((t=>{if("#"!==(t=t.trim()).charAt(0)&&""!==t.trim())switch(b){case 0:{const e=t.replaceAll(" ","").split(",");let n=0;e.forEach((t=>{p.includes(t)&&n++})),g=!(n==p.length),p=e,m=new s(p),b=1;break}case 100:{const e=t.replaceAll(" ","").split(",");let n=0;p.forEach((t=>{C[t]=e[n++]})),b=1;break}case 1:var k,I=t.split(" ");if(R(I[0],c))(k=I[1]in y?parseInt(y[I[1]]):parseInt(I[1]))!=e&&(e=k,g=!0,w=!0);else if(R(I[0],h)){var _;(_=I[1]in y?parseInt(y[I[1]]):parseInt(I[1]))!=n&&(n=_,g=!0,w=!0)}else R(I[0],u)&&(f="true"===I[1]);R(I[0],d)?b=100:I.length>1&&R(I[1],l)?(E=I[0],b=2):I.length>1&"="==I[1]&&(y[I[0]]=I[2]);break;case 2:S("DEFINE_CONDITIONALS");var W=!1;"."==(I=t.split(" "))[I.length-1].slice(-1)&&(S("TERMINATION "+I[0]),1==I.length&&(I[0]=I[0].slice(0,-1)),W=!0);var P=1;if(I.length>1&&R(I[1],a)&&R(I[2],r)&&(S("CHANCE"),I[3]in y&&(I[3]=y[I[3]]),P=parseFloat(I[3]),I.splice(1,3)),I.length>1&&"if"==I[1]){S("IF");for(var N=!1,M=null;!N;){var j=I[2].split("*");let t="",e=-1,n="=",s=1,a=9;if(j.length>1){let e=v(j[0]);s=e[0],a=e[1],t=j[1]}else t=j[0];const r=I[3];let l=new i(I[0],r,t,e,P,s,a);l.equality_type=n,m.addRule(E,l),null!=M&&(M.conjunctWith(l),l.do_evaluation=!1),I.length>4&&R(I[4],o)?(M=l,I.splice(2,3)):N=!0}}else{let t=new i(I[0],"always","",-1,P);m.addRule(E,t)}W&&(b=1)}})),{gridWidth:e,gridHeight:n,ruleset:m,wrap:f,stateCols:C}};function v(t){let e,n;if("["===t[0]&&"]"===t[t.length-1])t=(t=t.substring(1,t.length-1)).split(","),e=m(t[0]),n=m(t[1]);else if(">"===t[0]||"<"===t[0]){const i="="===t[1],s=t[0];t=t.substring(i?2:1,t.length),">"===s?(e=m(t),n=1/0,i||(e+=1)):"<"===s&&(e=0,n=m(t),i||(n+=1))}else e=m(t),n=e;return[e,n]}const m=function(t){return t in y?parseInt(y[t]):parseInt(t)},R=function(t,e){return e.includes(t.toLowerCase())},S=function(t){console.log("INTERPRETER: "+t)}},803:(t,e,n)=>{"use strict";n.r(e),n.d(e,{clearGrid:()=>W,evolveDraw:()=>N,loadPreset:()=>j,pauseUnpause:()=>m,play:()=>E,recalculateGridSize:()=>d,updateRules:()=>_});var i=n(686),s=n(829),a=n(632);const r=document.getElementById("grid-canvas"),l=r.getContext("2d");let o=64,c=64,h=r.clientWidth/o,u=r.clientHeight/c;function d(){R(),h=r.clientWidth/o,u=r.clientHeight/c,f.width=o,f.height=c,P(I,!1)}let f=null,g=!1,w=0,p="",y=null,b={};const v=function(){if(null!=f)for(let t=0;t<c;t++)for(let e=0;e<o;e++)l.fillStyle=b[f.getCellState(e,t)],l.fillRect(Math.floor(h*e),Math.floor(u*t),Math.ceil(h),Math.ceil(u))},m=function(){g?R():(S(),E())},R=function(){g=!1,document.getElementById("play-button").innerHTML="Play"},S=function(){g=!0,document.getElementById("play-button").innerHTML="Pause"},E=function(){g&&(w++%10==0&&N(),requestAnimationFrame(E))},C=function(t,e){const n=document.getElementById(t);null!=n&&(n.style.animation="none",n.offsetWidth,n.style.animation=e)},k=function(t){null!=y&&(y.style.boxShadow="none"),y=document.getElementById(t),y.style.boxShadow="white 0 0 10px",p=t};let I=null;const _=function(t=!1){const e=document.getElementById("rule_input_box").value||I;if(""==e)return;const n=(0,s.interpretRules)(e);o=n.gridWidth,c=n.gridHeight,I=n.ruleset,b=n.stateCols;const a=document.getElementById("state_picker");a.innerHTML="",I.states.forEach((t=>{const e=document.createElement("div");e.id=t,e.className="state",e.style.backgroundColor=b[t],e.onclick=function(){k(t)},a.appendChild(e)})),null==f||n.gridWidth!=f.width||n.gridHeight!=f.height?(f=new i.default(n.gridWidth,n.gridHeight,I,b,n.wrap),d()):f.rules=I,t?(d(),P(I)):k(p),C("grid_canvas","rules_save 1s")},W=function(){f.resetGrid(),k(f.rules.getDefaultState()),C("grid_canvas","grid_clear 1s"),v()},P=function(t,e=!0){f.resetGrid(e),k(t.getDefaultState()),v()},N=function(){f.evolve(),v()};v(),document.onkeydown=function(t){if((t=t||window).ctrlKey)switch(t.key){case"s":_(),v(),t.preventDefault(),t.stopPropagation();break;case"x":W()}};let M=!1;r.addEventListener("mousedown",(function(){M=!0}),!1),r.addEventListener("mouseup",(function(){M=!1}),!1),r.addEventListener("mousemove",(t=>{if(M){const e=t.target.getBoundingClientRect(),n=t.clientX-e.left,i=t.clientY-e.top,s=Math.floor(n/h),a=Math.floor(i/u);f.setCellState(s,a,p),v()}}),!1);const j=function(t){I=a.default.get(t),document.getElementById("rule_input_box").value=I,_(!0)};document.addEventListener("DOMContentLoaded",(function(){document.getElementById("step").addEventListener("click",(function(){f.evolve(),v()})),document.getElementById("updateRules").addEventListener("click",_),document.getElementById("clear-grid").addEventListener("click",W),document.getElementById("play-button").addEventListener("click",m),document.getElementById("template_selection_box").addEventListener("change",(function(){j(this.value)})),j("life")}))},632:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>a});const i=new Map,s=n(177);s.keys().forEach((t=>{const e=s(t).default,n=t.split("/")[1].split(".")[0];i.set(n,e)}));const a=i},761:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const i="Void, Air, Wall\n@colors\nblack, white, black\n\nq = .9\n\nAir ->\nWall with prob q if >4*Wall nearby\nAir.\n\nWall ->\nWall if >3*Wall nearby\nAir.\n\n# populate empty grid\nVoid ->\nAir with chance 0.5\nWall.\n\n@width 64\n@height 64\n@wrap true"},200:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const i="0, n, e, s, w, border, emitter\n@colors\nblack, white, gray, white, gray, maroon, orange\n\n0 becomes:\n# n,e,s,w move as normally\nn if emitter below\ne if emitter left\ns if emitter above\nw if emitter right\nn if n below\ne if e left\ns if s above\nw if w right\n# random off-shoots\nn with chance .025 if e below\nn with chance .025 if w below\ns with chance .025 if e above\ns with chance .025 if w above\ne with chance .025 if n left\ne with chance .025 if s left\nw with chance .025 if n right\nw with chance .025 if s right\nborder if 3*n nearby\nborder if 3*e nearby\nborder if 3*s nearby\nborder if 3*w nearby\nemitter with chance 0.00025 if 8*0 nearby\n0 otherwise."},609:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const i="Void, Dead, Alive\n@colors\nblack, black, white\n\nDead ->\nAlive if 3*Alive nearby\nDead otherwise.\n\nAlive ->\nAlive if [2,3]*Alive nearby\nDead otherwise.\n\n# populate empty grid\nVoid ->\nAlive with chance 0.2\nDead otherwise.\n\n@width 100\n@height 100\n@wrap true"},133:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const i="Nil, Rock, Paper, Scissors\n@colors\nblack, red, yellow, orange\n\nt = 3\np = 1\n\nRock ->\nPaper with prob p if >=t*Paper nearby\nRock otherwise.\n\nPaper ->\nScissors with prob p if >=t*Scissors nearby\nPaper otherwise.\n\nScissors ->\nRock with prob p if >=t*Rock nearby\nScissors otherwise.\n\n# populate empty grid\nNil ->\nRock with chance .3\nPaper with chance .3\nScissors with chance .3\nNil.\n\n@width 100\n@height 100\n@wrap true"},804:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const i="0, 1, 2, 3, 4, 5\n@colors\nblack, #888888, #666666, #444444, #222222, #111111\n\n@width 64\n@height 64\n@wrap true\n\np = 0.25\nq = .75\ns = 0.001\n\n0 becomes:\n1 with chance s\n1 with chance p if 1 nearby\n2 with chance q if 1 nearby\n2 with chance p if 2 nearby\n3 with chance q if 2 nearby\n3 with chance p if 3 nearby\n4 with chance q if 3 nearby\n4 with chance p if 4 nearby\n5 with chance q if 4 nearby\n5 with chance p if 5 nearby\n0 otherwise.\n\n1 becomes:\n3 if 0*0 nearby and 0*1 nearby\n1 otherwise."},233:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const i="\n# TRON\n# by cjphs\n\nVoid, Grid, RN, RE, RS, RW, Past, Past2\n@colors\nblack, black, red, red, red, red, purple, navy\n\np = .1\n\nVoid ->\nRN with chance p\nRE with chance p\nRW with chance p\nRS with chance p\nGrid.\n\n# turn chance\nq = .1\n\nGrid ->\nRE with chance q if 1*RN below\nRW with chance q if 1*RN below\nRE with chance q if 1*RS above\nRW with chance q if 1*RS above\nRN with chance q if 1*RE left\nRS with chance q if 1*RE left\nRN with chance q if 1*RW right\nRS with chance q if 1*RW right\nRN if 1*RN below\nRE if 1*RE left\nRS if 1*RS above\nRW if 1*RW right\nGrid.\n\nRN ->\nPast.\n\nRE ->\nPast.\n\nRS ->\nPast.\n\nRW ->\nPast.\n\nPast ->\nPast2.\n\nPast2 ->\nGrid."},177:(t,e,n)=>{var i={"./caves.js":761,"./city.js":200,"./life.js":609,"./rockpaperscissors.js":133,"./texture.js":804,"./trontinis.js":233};function s(t){var e=a(t);return n(e)}function a(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}s.keys=function(){return Object.keys(i)},s.resolve=a,t.exports=s,s.id=177}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var a=e[i]={exports:{}};return t[i](a,a.exports,n),a.exports}n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(829),n(632),n(686),n(803)})();